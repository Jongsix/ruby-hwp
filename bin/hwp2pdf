#!/usr/bin/ruby1.9.1
# coding: utf-8
# apt-get install libole-ruby or gem install ruby-ole
# 한글과컴퓨터의 글 문서 파일(.hwp) 공개 문서를 참고하여 개발하였습니다.

require 'optparse'

begin
    require 'hwp'
rescue Exception
    $LOAD_PATH << File.expand_path(File.dirname(__FILE__)) + '/../lib'
    require 'hwp'
end

require 'pango'
require 'cairo'

opts = {}
op = OptionParser.new do |op|
	#op.banner = "Usage: hwp2txt [OPTION] [FILE]"
	op.banner = "Usage: hwp2pdf [OPTION] [FILE]"
	op.separator ' '
	#op.separator "Output control:"
	op.on('-o', '--output=FILE', 'output file') { opts[:action] = :output }
	#op.separator ''
	op.on_tail('-h', '--help', 'Show this message') { puts op; exit }
end

files = op.parse ARGV

if files.empty?
	puts 'Must specify 1 .hwp file.'
	puts op
	exit 1
end

hwp = HWP.open files[0]
hwp.close


__END__

require 'gtk2'
require 'cairo'
require 'hwp'

page = Hwp::Page.new

def on_expose(surface)
    cr = Cairo::Context.new(surface)
    Hwp.page_render(page, cr)
    cr.destroy
end

doc = Hwp::Document.new file
page = doc.get_page(0)
n_pages = doc.get_n_pages(doc)

win = Gtk::Window.new
win.signal_connect("destroy") { Gtk.main_quit }
win.signal_connect("expose")  { on_expose }
win.show_all

Gtk.main
